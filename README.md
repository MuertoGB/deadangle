This code is buggy and fucked. Don't use it. More to come.